================================================================================
STEP-BY-STEP PROJECT IMPLEMENTATION GUIDE
================================================================================

PROJECT: Multi-Agent Durable AI Workflow
FROM: Initial Setup â†’ Full Deployment

This guide walks you through building this project from scratch to production.

================================================================================
PHASE 1: PREREQUISITES & ENVIRONMENT SETUP
================================================================================

STEP 1.1: Install Required Software
------------------------------------
â–¡ Install .NET 8.0 SDK
  Download: https://dotnet.microsoft.com/download/dotnet/8.0
  Verify: dotnet --version

â–¡ Install Visual Studio 2022 or VS Code
  VS Code: https://code.visualstudio.com/
  Extensions: C#, Azure Functions, Azure Account

â–¡ Install Azure Functions Core Tools
  Command: npm install -g azure-functions-core-tools@4
  Verify: func --version

â–¡ Install Azure CLI
  Download: https://docs.microsoft.com/cli/azure/install-azure-cli
  Verify: az --version

â–¡ Install Node.js (for Azure Functions tools)
  Download: https://nodejs.org/
  Verify: node --version


STEP 1.2: Azure Account Setup
------------------------------
â–¡ Create Azure Account
  Sign up: https://azure.microsoft.com/free/

â–¡ Login to Azure CLI
  Command: az login
  Follow browser authentication

â–¡ Set Default Subscription (if multiple)
  Command: az account set --subscription "Your-Subscription-Name"


STEP 1.3: Install AI/ML Tools (Optional for Local Development)
---------------------------------------------------------------
â–¡ Install Ollama (for local LLM)
  Download: https://ollama.ai/
  Pull model: ollama pull llama3

â–¡ Install Python (for LangChain)
  Download: https://www.python.org/downloads/
  Verify: python --version


================================================================================
PHASE 2: PROJECT CREATION
================================================================================

STEP 2.1: Create Solution Structure
------------------------------------
â–¡ Create project directory
  mkdir multi_agents
  cd multi_agents
  mkdir "Ai_ Frontend"
  cd "Ai_ Frontend"

â–¡ Create .NET solution
  dotnet new sln -n "Ai_ Frontend"


STEP 2.2: Create Blazor Frontend Project
-----------------------------------------
â–¡ Create Blazor Server project
  dotnet new blazor -n multiple_Agents -o multiple_Agents

â–¡ Add to solution
  dotnet sln add multiple_Agents/multiple_Agents.csproj

â–¡ Verify project builds
  cd multiple_Agents
  dotnet build
  cd ..


STEP 2.3: Create Azure Functions Backend Project
-------------------------------------------------
â–¡ Create Functions project
  func init DurableBackend --worker-runtime dotnet-isolated --target-framework net8.0

â–¡ Add Durable Functions support
  cd DurableBackend
  dotnet add package Microsoft.Azure.Functions.Worker.Extensions.DurableTask
  dotnet add package Microsoft.Azure.Functions.Worker.Extensions.Http

â–¡ Add to solution
  cd ..
  dotnet sln add DurableBackend/DurableBackend.csproj


================================================================================
PHASE 3: BACKEND IMPLEMENTATION (AZURE FUNCTIONS)
================================================================================

STEP 3.1: Create HTTP Trigger Function
---------------------------------------
â–¡ Create HttpStart.cs file
  Location: DurableBackend/HttpStart.cs
  
  Code:
  ```csharp
  using Microsoft.Azure.Functions.Worker;
  using Microsoft.Azure.Functions.Worker.Http;
  using Microsoft.DurableTask.Client;
  using System.Net;

  namespace DurableBackend;

  public static class HttpStart
  {
      [Function("StartConversation")]
      public static async Task<HttpResponseData> Run(
          [HttpTrigger(AuthorizationLevel.Anonymous, "get", Route = "start/{input}")]
          HttpRequestData req,
          string input,
          [DurableClient] DurableTaskClient client)
      {
          string instanceId = await client.ScheduleNewOrchestrationInstanceAsync(
              "ConversationOrchestrator", input);

          var response = req.CreateResponse(HttpStatusCode.OK);
          response.Headers.Add("Content-Type", "application/json");
          await response.WriteStringAsync($"{{ \"instanceId\": \"{instanceId}\" }}");
          return response;
      }
  }
  ```


STEP 3.2: Create Orchestrator Function
---------------------------------------
â–¡ Create ConversationOrchestrator.cs
  Location: DurableBackend/ConversationOrchestrator.cs
  
  Code:
  ```csharp
  using Microsoft.Azure.Functions.Worker;
  using Microsoft.DurableTask;

  namespace DurableBackend;

  public static class ConversationOrchestrator
  {
      [Function("ConversationOrchestrator")]
      public static async Task<object> Run(
          [OrchestrationTrigger] TaskOrchestrationContext context)
      {
          var input = context.GetInput<string>();
          var result = await context.CallActivityAsync<string>("GraphActivity", input);
          return new { result };
      }
  }
  ```


STEP 3.3: Create Activity Function
-----------------------------------
â–¡ Create GraphActivity.cs
  Location: DurableBackend/GraphActivity.cs
  
  Code:
  ```csharp
  using Microsoft.Azure.Functions.Worker;
  using Microsoft.Extensions.Logging;
  using DurableBackend.AI;

  namespace DurableBackend;

  public class GraphActivity
  {
      private readonly LangGraphAgent _agent;
      private readonly ILogger<GraphActivity> _logger;

      public GraphActivity(LangGraphAgent agent, ILogger<GraphActivity> logger)
      {
          _agent = agent;
          _logger = logger;
      }

      [Function("GraphActivity")]
      public async Task<string> Run([ActivityTrigger] string input)
      {
          try
          {
              _logger.LogInformation("GraphActivity started with input: {Input}", input);
              var result = await _agent.RunAsync(input);
              _logger.LogInformation("GraphActivity completed successfully.");
              return result;
          }
          catch (Exception ex)
          {
              _logger.LogError(ex, "GraphActivity failed: {Message}", ex.Message);
              throw;
          }
      }
  }
  ```


STEP 3.4: Create AI Components
-------------------------------
â–¡ Create AI directory structure
  mkdir DurableBackend/AI
  mkdir DurableBackend/AI/Graph

â–¡ Create IAiClient.cs interface
  Location: DurableBackend/AI/IAiClient.cs

â–¡ Create LangChainAiClient.cs
  Location: DurableBackend/AI/LangChainAiClient.cs

â–¡ Create AgentState.cs
  Location: DurableBackend/AI/Graph/AgentState.cs

â–¡ Create LangGraphAgent.cs
  Location: DurableBackend/AI/Graph/LangGraphAgent.cs

â–¡ Create AnalysisNode.cs
  Location: DurableBackend/AI/Graph/AnalysisNode.cs

â–¡ Create ResponseNode.cs
  Location: DurableBackend/AI/Graph/ResponseNode.cs

â–¡ Create StateGraph.cs
  Location: DurableBackend/AI/Graph/StateGraph.cs


STEP 3.5: Configure Dependency Injection
-----------------------------------------
â–¡ Update Program.cs
  Location: DurableBackend/Program.cs
  
  Add services:
  ```csharp
  builder.Services.AddSingleton<IAiClient, LangChainAiClient>();
  builder.Services.AddSingleton<LangGraphAgent>();
  ```


STEP 3.6: Configure Local Settings
-----------------------------------
â–¡ Create/Update local.settings.json
  Location: DurableBackend/local.settings.json
  
  Content:
  ```json
  {
    "IsEncrypted": false,
    "Values": {
      "AzureWebJobsStorage": "UseDevelopmentStorage=true",
      "FUNCTIONS_WORKER_RUNTIME": "dotnet-isolated"
    }
  }
  ```


STEP 3.7: Test Backend Locally
-------------------------------
â–¡ Run Azure Functions locally
  cd DurableBackend
  dotnet run

â–¡ Test HTTP endpoint
  curl http://localhost:7071/api/start/test

â–¡ Verify function executes successfully


================================================================================
PHASE 4: FRONTEND IMPLEMENTATION (BLAZOR)
================================================================================

STEP 4.1: Configure HTTP Client
--------------------------------
â–¡ Update Program.cs
  Location: multiple_Agents/Program.cs
  
  Add HTTP client:
  ```csharp
  builder.Services.AddHttpClient("durable", (sp, client) => {
      var config = sp.GetRequiredService<IConfiguration>();
      var backendUrl = config["DurableBackendUrl"] ?? "http://localhost:7071";
      client.BaseAddress = new Uri(backendUrl);
  });
  ```


STEP 4.2: Create UI Components
-------------------------------
â–¡ Update Home.razor
  Location: multiple_Agents/Components/Pages/Home.razor
  
  Add:
  - Input field for user text
  - "Start Workflow" button
  - Status display
  - Result display
  - StartWorkflow() method
  - PollStatus() method


STEP 4.3: Configure App Settings
---------------------------------
â–¡ Update appsettings.json
  Location: multiple_Agents/appsettings.json
  
  Add:
  ```json
  {
    "DurableBackendUrl": "http://localhost:7071"
  }
  ```


STEP 4.4: Test Frontend Locally
--------------------------------
â–¡ Run Blazor app
  cd multiple_Agents
  dotnet run

â–¡ Open browser to displayed URL (e.g., https://localhost:5001)

â–¡ Test workflow with sample input


================================================================================
PHASE 5: LOCAL TESTING & DEBUGGING
================================================================================

STEP 5.1: Run Both Applications
--------------------------------
â–¡ Terminal 1: Start Backend
  cd DurableBackend
  dotnet run
  Wait for: "Functions: StartConversation: [GET] http://localhost:7071/api/start/{input}"

â–¡ Terminal 2: Start Frontend
  cd multiple_Agents
  dotnet run
  Wait for: "Now listening on: https://localhost:XXXX"


STEP 5.2: Test End-to-End Workflow
-----------------------------------
â–¡ Open browser to frontend URL

â–¡ Enter test input: "Hello World"

â–¡ Click "Start Workflow"

â–¡ Verify status updates:
  - "Starting workflow..."
  - "Workflow started (ID: ...)"
  - "Workflow status: Running"
  - "Workflow completed"

â–¡ Verify result displays correctly


STEP 5.3: Debug Issues
-----------------------
â–¡ Check backend logs in Terminal 1
  Look for: "GraphActivity started with input: ..."

â–¡ Check frontend logs in Terminal 2
  Look for HTTP request logs

â–¡ Use browser DevTools (F12) to check network requests

â–¡ Verify both applications are running without errors


================================================================================
PHASE 6: AZURE DEPLOYMENT PREPARATION
================================================================================

STEP 6.1: Create Azure Resources
---------------------------------
â–¡ Login to Azure
  az login

â–¡ Create Resource Group
  az group create --name durable-rg --location southindia

â–¡ Create Storage Account
  az storage account create \
    --name durablebackendstorage \
    --resource-group durable-rg \
    --location southindia \
    --sku Standard_LRS

â–¡ Create Function App
  az functionapp create \
    --resource-group durable-rg \
    --consumption-plan-location southindia \
    --runtime dotnet-isolated \
    --runtime-version 8 \
    --functions-version 4 \
    --name durable-backend-fn \
    --storage-account durablebackendstorage


STEP 6.2: Configure Function App Settings
------------------------------------------
â–¡ Enable Application Insights
  Automatically enabled during creation

â–¡ Configure CORS (if needed)
  az functionapp cors add \
    --name durable-backend-fn \
    --resource-group durable-rg \
    --allowed-origins "*"


================================================================================
PHASE 7: DEPLOY TO AZURE
================================================================================

STEP 7.1: Deploy Backend to Azure
----------------------------------
â–¡ Navigate to backend directory
  cd DurableBackend

â–¡ Publish to Azure
  func azure functionapp publish durable-backend-fn --verbose

â–¡ Wait for deployment to complete
  Look for: "Deployment successful"

â–¡ Note the function URLs displayed


STEP 7.2: Verify Azure Deployment
----------------------------------
â–¡ List deployed functions
  func azure functionapp list-functions durable-backend-fn

â–¡ Test Azure endpoint
  curl https://durable-backend-fn.azurewebsites.net/api/start/test

â–¡ Check Azure Portal
  - Navigate to Function App
  - Verify functions are listed
  - Check "Log stream" for activity


STEP 7.3: Update Frontend Configuration
----------------------------------------
â–¡ Update appsettings.json
  Location: multiple_Agents/appsettings.json
  
  Change to:
  ```json
  {
    "DurableBackendUrl": "https://durable-backend-fn.azurewebsites.net"
  }
  ```


STEP 7.4: Test with Azure Backend
----------------------------------
â–¡ Stop local backend (Terminal 1)

â–¡ Restart frontend
  cd multiple_Agents
  dotnet run

â–¡ Test workflow with Azure backend

â–¡ Verify workflow completes successfully


================================================================================
PHASE 8: PRODUCTION DEPLOYMENT (OPTIONAL)
================================================================================

STEP 8.1: Deploy Frontend to Azure (Optional)
----------------------------------------------
â–¡ Create App Service
  az webapp create \
    --resource-group durable-rg \
    --plan myAppServicePlan \
    --name my-blazor-frontend \
    --runtime "DOTNET|8.0"

â–¡ Deploy frontend
  cd multiple_Agents
  dotnet publish -c Release
  az webapp deploy --resource-group durable-rg \
    --name my-blazor-frontend \
    --src-path bin/Release/net8.0/publish


STEP 8.2: Configure Production Settings
----------------------------------------
â–¡ Set environment-specific configurations

â–¡ Enable HTTPS enforcement

â–¡ Configure authentication (if needed)

â–¡ Set up custom domains (if needed)


================================================================================
PHASE 9: MONITORING & MAINTENANCE
================================================================================

STEP 9.1: Set Up Monitoring
----------------------------
â–¡ Enable Application Insights
  Already enabled during Function App creation

â–¡ View logs in Azure Portal
  Function App â†’ Log stream

â–¡ Stream logs from CLI
  func azure functionapp logstream durable-backend-fn


STEP 9.2: Monitor Performance
------------------------------
â–¡ Check Application Insights dashboard
  - Request rates
  - Response times
  - Failure rates
  - Dependencies

â–¡ Set up alerts for failures


STEP 9.3: Regular Maintenance
------------------------------
â–¡ Update NuGet packages regularly
  dotnet list package --outdated
  dotnet add package <PackageName>

â–¡ Review and optimize costs
  Check Azure Cost Management

â–¡ Backup configurations
  Export ARM templates from Azure Portal


================================================================================
PHASE 10: TROUBLESHOOTING COMMON ISSUES
================================================================================

ISSUE 1: Port Already in Use
-----------------------------
Problem: "Port 7071 is unavailable"
Solution:
  netstat -ano | findstr :7071
  Stop-Process -Id <PID> -Force


ISSUE 2: 404 Not Found on Azure
--------------------------------
Problem: Azure endpoint returns 404
Solution:
  1. Verify functions are deployed:
     func azure functionapp list-functions durable-backend-fn
  2. Redeploy if needed:
     func azure functionapp publish durable-backend-fn


ISSUE 3: Frontend Can't Connect
--------------------------------
Problem: Frontend shows connection errors
Solution:
  1. Check DurableBackendUrl in appsettings.json
  2. Verify backend is running (local or Azure)
  3. Check CORS settings on Azure


ISSUE 4: GraphActivity Fails
-----------------------------
Problem: Activity function throws errors
Solution:
  1. Check AI client configuration
  2. Verify Ollama/LangChain is running
  3. Check logs for detailed error messages


ISSUE 5: Workflow Never Completes
----------------------------------
Problem: Status stays "Running"
Solution:
  1. Check Azure logs for errors
  2. Verify orchestrator code is correct
  3. Check activity function completes successfully


================================================================================
PHASE 11: ENHANCEMENTS & NEXT STEPS
================================================================================

ENHANCEMENT 1: Add Authentication
----------------------------------
â–¡ Implement Azure AD authentication
â–¡ Add user roles and permissions
â–¡ Secure API endpoints


ENHANCEMENT 2: Improve UI/UX
-----------------------------
â–¡ Add loading animations
â–¡ Implement conversation history
â–¡ Add export functionality
â–¡ Improve error messages


ENHANCEMENT 3: Optimize Performance
------------------------------------
â–¡ Implement caching
â–¡ Add response streaming
â–¡ Optimize AI model calls
â–¡ Implement rate limiting


ENHANCEMENT 4: Add Features
----------------------------
â–¡ Multiple AI model support
â–¡ Batch processing
â–¡ Webhook notifications
â–¡ A/B testing capabilities


================================================================================
CHECKLIST SUMMARY
================================================================================

PREREQUISITES
â–¡ .NET 8.0 SDK installed
â–¡ Azure Functions Core Tools installed
â–¡ Azure CLI installed
â–¡ Azure account created

PROJECT SETUP
â–¡ Solution created
â–¡ Blazor frontend project created
â–¡ Azure Functions backend project created

BACKEND IMPLEMENTATION
â–¡ HTTP trigger function created
â–¡ Orchestrator function created
â–¡ Activity function created
â–¡ AI components implemented
â–¡ Dependency injection configured

FRONTEND IMPLEMENTATION
â–¡ HTTP client configured
â–¡ UI components created
â–¡ App settings configured

LOCAL TESTING
â–¡ Backend runs locally
â–¡ Frontend runs locally
â–¡ End-to-end workflow tested

AZURE DEPLOYMENT
â–¡ Azure resources created
â–¡ Backend deployed to Azure
â–¡ Frontend configuration updated
â–¡ Azure deployment tested

PRODUCTION (OPTIONAL)
â–¡ Frontend deployed to Azure
â–¡ Production settings configured
â–¡ Monitoring enabled


================================================================================
QUICK REFERENCE COMMANDS
================================================================================

LOCAL DEVELOPMENT
-----------------
# Start backend
cd DurableBackend && dotnet run

# Start frontend
cd multiple_Agents && dotnet run

# Test endpoint
curl http://localhost:7071/api/start/test


AZURE DEPLOYMENT
----------------
# Deploy backend
cd DurableBackend
func azure functionapp publish durable-backend-fn

# List functions
func azure functionapp list-functions durable-backend-fn

# Stream logs
func azure functionapp logstream durable-backend-fn


TROUBLESHOOTING
---------------
# Check port usage
netstat -ano | findstr :7071

# Kill process
Stop-Process -Id <PID> -Force

# Check Azure status
az functionapp show --name durable-backend-fn --resource-group durable-rg


================================================================================
ESTIMATED TIME TO COMPLETE
================================================================================

Phase 1: Prerequisites (30-60 minutes)
Phase 2: Project Creation (15 minutes)
Phase 3: Backend Implementation (2-3 hours)
Phase 4: Frontend Implementation (1-2 hours)
Phase 5: Local Testing (30 minutes)
Phase 6: Azure Preparation (30 minutes)
Phase 7: Azure Deployment (30 minutes)
Phase 8: Production Deployment (1 hour) - Optional
Phase 9: Monitoring Setup (30 minutes)

TOTAL: 6-9 hours (excluding optional production deployment)


================================================================================
RESOURCES & DOCUMENTATION
================================================================================

Official Documentation:
- .NET: https://docs.microsoft.com/dotnet/
- Blazor: https://docs.microsoft.com/aspnet/core/blazor/
- Azure Functions: https://docs.microsoft.com/azure/azure-functions/
- Durable Functions: https://docs.microsoft.com/azure/azure-functions/durable/

Community Resources:
- GitHub Issues & Discussions
- Stack Overflow
- Azure Community Forums


================================================================================
END OF IMPLEMENTATION GUIDE
================================================================================

Congratulations! You now have a complete guide to build and deploy
a Multi-Agent Durable AI Workflow application from scratch.

For questions or issues, refer to the troubleshooting section or
consult the official documentation.

Good luck with your project! ðŸš€
